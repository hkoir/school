{% extends "../base.html" %}
{% load custom_filters %}

{% block content %}

<style>
.account-name { padding-left: 0; }
.level-0 { padding-left: 0px; }
.level-1 { padding-left: 20px; }
.level-2 { padding-left: 40px; }
.level-3 { padding-left: 60px; }
/* Add more levels if needed */

</style>


{% include 'accounting/quick_access_link.html' %}

<div class="container mt-4">  

{% load custom_filters %}

<h2 class="my-4">Quarterly Balance Sheet</h2>
<div class="table-responsive">
    <table class="table table-bordered table-striped table-sm">
        <thead class="table-dark">
            <tr>
                <th>Account code</th>
                <th>Account</th>
                {% for fy in fiscal_years %}
                    {% for q in quarters %}
                        <th class="text-end">{{ fy.year_start.year }} {{ q }}</th>
                    {% endfor %}
                {% endfor %}
            </tr>
        </thead>
        <tbody>

            {% for node in report_tree %}
                {% include "accounting/account_row_quarterly.html" with node=node level=0 fiscal_years=fiscal_years quarters=quarters %}
            {% endfor %}

            <!-- Retained Earnings -->
            <tr class="fw-bold table-secondary">
                <td colspan="2" class="text-end">Retained Earnings (Net Profit)</td>
                {% for fy in fiscal_years %}
                    {% for q in quarters %}
                        <td class="text-end">
                            {{ totals|dict_get:fy.id|dict_get:q|dict_get:"net_profit"|floatformat:2 }}
                        </td>
                    {% endfor %}
                {% endfor %}
            </tr>

            <!-- Equity (Excluding Net Profit) -->
            <tr class="fw-bold table-light">
                <td colspan="2" class="text-end">Equity (Excl. Net Profit)</td>
                {% for fy in fiscal_years %}
                    {% for q in quarters %}
                        <td class="text-end">
                            {{ totals|dict_get:fy.id|dict_get:q|dict_get:"equity"|floatformat:2 }}
                        </td>
                    {% endfor %}
                {% endfor %}
            </tr>

            <!-- Totals -->
            <tr class="fw-bold table-dark">
                <td colspan="2" class="text-end">Total Assets</td>
                {% for fy in fiscal_years %}
                    {% for q in quarters %}
                        <td class="text-end">
                            {{ totals|dict_get:fy.id|dict_get:q|dict_get:"assets"|floatformat:2 }}
                        </td>
                    {% endfor %}
                {% endfor %}
            </tr>
            <tr class="fw-bold table-dark">
                <td colspan="2" class="text-end">Total Liabilities & Equity</td>
                {% for fy in fiscal_years %}
                    {% for q in quarters %}
                        <td class="text-end">
                            {{ totals|dict_get:fy.id|dict_get:q|dict_get:"liabilities_equity"|floatformat:2 }}
                        </td>
                    {% endfor %}
                {% endfor %}
            </tr>
        </tbody>
    </table>
</div>


</div>
{% endblock %}
